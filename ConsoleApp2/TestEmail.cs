using System;
using System.Web;
using System.IO;
using System.Net.Http.Headers;
using System.Text.Json.Nodes;
using System.Text.Json.Serialization;
using RestSharp;
using Newtonsoft.Json.Linq;
using System.Text.Json.Serialization.Metadata;
using Newtonsoft.Json;
using System.Net.Http.Json;
using System.Text;
using System.Text.Encodings.Web;

namespace ConsoleApp2
{
   public class TestEmail
    {

        public static void ExtractContent()
        {
            var oldBody = "{\r\n  \"contentType\": \"html\",\r\n  \"content\": \"\\u003Chtml\\u003E\\u003Chead\\u003E\\r\\n\\u003Cmeta http-equiv=\\u0022Content-Type\\u0022 content=\\u0022text/html; charset=utf-8\\u0022\\u003E\\u003Cmeta name=\\u0022Generator\\u0022 content=\\u0022Microsoft Word 15 (filtered medium)\\u0022\\u003E\\u003Cstyle\\u003E\\r\\n\\u003C!--\\r\\n@font-face\\r\\n\\t{font-family:\\u0022Cambria Math\\u0022}\\r\\n@font-face\\r\\n\\t{font-family:Calibri}\\r\\n@font-face\\r\\n\\t{font-family:\\u0022Segoe UI\\u0022}\\r\\np.MsoNormal, li.MsoNormal, div.MsoNormal\\r\\n\\t{margin:0in;\\r\\n\\tfont-size:11.0pt;\\r\\n\\tfont-family:\\u0022Calibri\\u0022,sans-serif}\\r\\na:link, span.MsoHyperlink\\r\\n\\t{color:#0563C1;\\r\\n\\ttext-decoration:underline none underline}\\r\\nspan.EmailStyle22\\r\\n\\t{font-family:\\u0022Calibri\\u0022,sans-serif;\\r\\n\\tcolor:windowtext}\\r\\n.MsoChpDefault\\r\\n\\t{font-size:10.0pt}\\r\\n@page WordSection1\\r\\n\\t{margin:1.0in 1.0in 1.0in 1.0in}\\r\\ndiv.WordSection1\\r\\n\\t{}\\r\\n--\\u003E\\r\\n\\u003C/style\\u003E\\u003C/head\\u003E\\u003Cbody lang=\\u0022EN-US\\u0022 link=\\u0022#0563C1\\u0022 vlink=\\u0022#954F72\\u0022 style=\\u0022word-wrap:break-word\\u0022\\u003E\\u003Cdiv class=\\u0022WordSection1\\u0022\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EFor Test ticket creation sample.\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp\\u003E\\u003Cstyle type=\\u0022text/css\\u0022\\u003E\\r\\n\\u003C!--\\r\\na\\r\\n\\t{color:inherit;\\r\\n\\ttext-decoration:none}\\r\\na:visited\\r\\n\\t{color:inherit}\\r\\n--\\u003E\\r\\n\\u003C/style\\u003E\\u003C/p\\u003E\\u003Ctable id=\\u0022mycustombanner\\u0022 style=\\u0022border:currentColor; width:500px; font-family:\\u0026quot;Segoe UI\\u0026quot;,Arial,sans-serif; font-size:12px; border-collapse:collapse; border-spacing:0px\\u0022\\u003E\\u003Ctbody\\u003E\\u003Ctr\\u003E\\u003Ctd style=\\u0022font-family:\\u0027Segoe UI\\u0027; font-size:12px; width:90px\\u0022\\u003E\\u003Ca href=\\u0022https://www.flintfox.com\\u0022\\u003E\\u003Cimg src=\\u0022cid:wEmEG6UPIkmcOaeM6qzIwFlintfox_ShorthandCustom_png\\u0022\\u003E\\u003C/a\\u003E\\u003C/td\\u003E\\u003Ctd style=\\u0022font-family:\\u0027Segoe UI\\u0027; font-size:12px\\u0022\\u003E\\u003Cspan style=\\u0022color:rgb(114,66,245)\\u0022\\u003E\\u003Cspan style=\\u0022font-weight:bold; font-size:14px\\u0022\\u003EChip Edwards\\u003C/span\\u003E \\u003C/span\\u003E\\u003Cspan style=\\u0022color:rgb(51,51,51)\\u0022\\u003E\\u003Cspan style=\\u0022font-weight:bold\\u0022\\u003E|\\u0026nbsp;Support Manager\\u003C/span\\u003E \\u003C/span\\u003E\\u003Ca style=\\u0022border:currentColor; color:rgb(79,79,79); line-height:1.6\\u0022\\u003E\\u003Cspan style=\\u0022color:rgb(51,51,51)\\u0022\\u003E\\u0026nbsp;\\u003C/span\\u003E \\u003C/a\\u003E\\u003Ca href=\\u0022mailto:cedwards@flintfox.com\\u0022 tabindex=\\u00220\\u0022 style=\\u0022color:rgb(79,79,79); line-height:1.6; text-decoration:none\\u0022\\u003E\\u003Cspan style=\\u0022color:rgb(51,51,51); text-decoration:none\\u0022\\u003E\\u0026nbsp; \\u003Cbr\\u003E\\u003Cb\\u003E\\u003Cspan style=\\u0022color:#333333\\u0022\\u003EE: \\u003C/span\\u003E\\u003C/b\\u003Ecedwards@flintfox.com\\u003C/span\\u003E \\u003C/a\\u003E\\u003Cspan style=\\u0022color:rgb(79,79,79); line-height:1.6; text-decoration:none\\u0022\\u003E\\u003C/span\\u003E\\u003Cbr\\u003E\\u003Cspan style=\\u0022color:rgb(79,79,79); line-height:1.6; text-decoration:none\\u0022\\u003E\\u003Ca href=\\u0022https://www.flintfox.com\\u0022 target=\\u0022_blank\\u0022\\u003Ehttps://www.flintfox.com\\u003C/a\\u003E\\u003C/span\\u003E\\u003C/td\\u003E\\u003C/tr\\u003E\\u003C/tbody\\u003E\\u003C/table\\u003E\\u003Cstyle type=\\u0022text/css\\u0022\\u003E\\r\\n\\u003C!--\\r\\na\\r\\n\\t{color:inherit;\\r\\n\\ttext-decoration:none}\\r\\na:visited\\r\\n\\t{color:inherit}\\r\\n--\\u003E\\r\\n\\u003C/style\\u003E\\u003Ctable id=\\u0022mycustombanner\\u0022 style=\\u0022width:950px; font-family:\\u0026quot;Segoe UI\\u0026quot;,Arial,sans-serif; font-size:9px; border:none; border-collapse:collapse; border-spacing:0px\\u0022\\u003E\\u003Ctbody\\u003E\\u003Ctr\\u003E\\u003Ctd style=\\u0022width:945px\\u0022\\u003E\\u003Cp style=\\u0022font-family:\\u0027Segoe UI\\u0027; font-size:9px; color:rgb(79,79,79)\\u0022\\u003E\\u003Cbr\\u003E\\u003Cspan style=\\u0022font-weight:bold\\u0022\\u003EDisclaimer \\u0026nbsp;\\u003C/span\\u003E\\u003Ca style=\\u0022color:rgb(79,79,79); line-height:1.2; border:none\\u0022\\u003E\\u003Cspan style=\\u0022color:#333333\\u0022\\u003E \\u003C/span\\u003E\\u003C/a\\u003E\\u003Ca style=\\u0022color:rgb(79,79,79); line-height:1.2; border:none\\u0022\\u003E\\u003Cbr\\u003E\\u003Cspan style=\\u0022color:#333333\\u0022\\u003EIf you are not the addressee indicated in this message (or responsible for delivery of the message) you may not deliver or copy this message to anyone. In such case you should destroy this message and kindly notify the sender. Opinions, conclusions and other information in this message that do not relate to the official business of Flintfox International Limited shall be understood as neither given nor endorsed by it.\\u003C/span\\u003E\\u003C/a\\u003E\\u003C/p\\u003E\\u003Ca style=\\u0022color:rgb(79,79,79); line-height:1.6; border:none\\u0022\\u003E\\u003C/a\\u003E\\u003C/td\\u003E\\u003C/tr\\u003E\\u003C/tbody\\u003E\\u003C/table\\u003E\\u003Cdiv\\u003E\\u003Cdiv style=\\u0022border:none; border-top:solid #E1E1E1 1.0pt; padding:3.0pt 0in 0in 0in\\u0022\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u003Cb\\u003EFrom:\\u003C/b\\u003E Al-Karim Jetha \\u0026lt;\\u003Ca href=\\u0022mailto:ajetha@Flintfox.com\\u0022\\u003Eajetha@Flintfox.com\\u003C/a\\u003E\\u0026gt; \\u003Cbr\\u003E\\u003Cb\\u003ESent:\\u003C/b\\u003E Wednesday, January 18, 2023 10:28 PM\\u003Cbr\\u003E\\u003Cb\\u003ETo:\\u003C/b\\u003E Support - Favorite Brands \\u0026lt;\\u003Ca href=\\u0022mailto:Support-FavoriteBrands@flintfox.com\\u0022\\u003ESupport-FavoriteBrands@flintfox.com\\u003C/a\\u003E\\u0026gt;\\u003Cbr\\u003E\\u003Cb\\u003ESubject:\\u003C/b\\u003E [T20230119.0015] : Issue with break import\\u003C/p\\u003E\\u003C/div\\u003E\\u003C/div\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EHello Team!\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EWe are seeing an issue when exporting a TA where it has break component and the break is setup with multiple rewards lines. This is occurring in FB v8.2 however I have tested the same in v8.5.1 and seeing expected data in the export.\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EThe break component used is:\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u003Cimg border=\\u00220\\u0022 width=\\u0022565\\u0022 height=\\u0022236\\u0022 id=\\u0022Picture_x0020_1\\u0022 src=\\u0022cid:image001.png@01D92B8C.443AF2B0\\u0022 style=\\u0022width:5.8854in; height:2.4583in\\u0022\\u003E\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u003Cimg border=\\u00220\\u0022 width=\\u0022597\\u0022 height=\\u0022334\\u0022 id=\\u0022Picture_x0020_2\\u0022 src=\\u0022cid:image002.png@01D92B8C.443AF2B0\\u0022 style=\\u0022width:6.2187in; height:3.4791in\\u0022\\u003E\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EWhen this trade agreement is exported, I am expecting to see the rewards values too on the export however now seeing those.\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u003Cimg border=\\u00220\\u0022 width=\\u00221241\\u0022 height=\\u0022161\\u0022 id=\\u0022Picture_x0020_3\\u0022 src=\\u0022cid:image003.png@01D92B8C.443AF2B0\\u0022 style=\\u0022width:12.927in; height:1.677in\\u0022\\u003E\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EIn Fildemo, it looks correct\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u003Cimg border=\\u00220\\u0022 width=\\u00221506\\u0022 height=\\u0022152\\u0022 id=\\u0022Picture_x0020_4\\u0022 src=\\u0022cid:image004.png@01D92B8C.443AF2B0\\u0022 style=\\u0022width:15.6875in; height:1.5833in\\u0022\\u003E\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EEntity that is exported is:\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u003Cimg border=\\u00220\\u0022 width=\\u00221179\\u0022 height=\\u002263\\u0022 id=\\u0022Picture_x0020_5\\u0022 src=\\u0022cid:image005.png@01D92B8C.443AF2B0\\u0022 style=\\u0022width:12.2812in; height:.6562in\\u0022\\u003E\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EContact me if there are further questions.\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EThank you,\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003EKarim\\u003C/p\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003Ctable class=\\u0022MsoNormalTable\\u0022 border=\\u00220\\u0022 cellspacing=\\u00220\\u0022 cellpadding=\\u00220\\u0022 width=\\u0022500\\u0022 id=\\u0022template\\u0022 style=\\u0022width:375.0pt; border-collapse:collapse; border:currentColor; border-spacing:0px\\u0022\\u003E\\u003Ctbody\\u003E\\u003Ctr\\u003E\\u003Ctd style=\\u0022padding:0in 0in 0in 0in\\u0022\\u003E\\u003Cp style=\\u0022margin:0in\\u0022\\u003E\\u003Cspan style=\\u0022font-size:9.0pt; font-family:\\u0026quot;Segoe UI\\u0026quot;,sans-serif\\u0022\\u003E\\u003Cbr\\u003E\\u003C/span\\u003E\\u003Cb\\u003E\\u003Cspan style=\\u0022font-size:10.5pt; font-family:\\u0026quot;Segoe UI\\u0026quot;,sans-serif; color:#7242F5\\u0022\\u003EAl-Karim Jetha\\u003C/span\\u003E\\u003C/b\\u003E\\u003Cspan style=\\u0022font-size:9.0pt; font-family:\\u0026quot;Segoe UI\\u0026quot;,sans-serif; color:#333333\\u0022\\u003E \\u003Cb\\u003E|\\u0026nbsp;Senior Consultant\\u0026nbsp;\\u003C/b\\u003E\\u0026nbsp;\\u003Cbr\\u003E\\u003Cb\\u003EM: \\u003C/b\\u003E\\u002B1 416 671 7135 \\u003C/span\\u003E\\u003Cspan style=\\u0022font-size:9.0pt; font-family:\\u0026quot;Segoe UI\\u0026quot;,sans-serif\\u0022\\u003E\\u003C/span\\u003E\\u003C/p\\u003E\\u003Cp style=\\u0022margin:0in\\u0022\\u003E\\u003Cspan style=\\u0022font-size:9.0pt; font-family:\\u0026quot;Segoe UI\\u0026quot;,sans-serif\\u0022\\u003E\\u0026nbsp;\\u003C/span\\u003E\\u003C/p\\u003E\\u003C/td\\u003E\\u003C/tr\\u003E\\u003C/tbody\\u003E\\u003C/table\\u003E\\u003Cp class=\\u0022MsoNormal\\u0022\\u003E\\u0026nbsp;\\u003C/p\\u003E\\u003C/div\\u003E\\u003C/body\\u003E\\u003C/html\\u003E\"\r\n}";
            var ffContent = my.Default.UTF8Message;

            string newContent = "";

            // 1. Extract "content" from old message to var oldContent
            // 2. Convert "oldContent to UTF-8 with proper escape sequences
            // 3. Create  string newContent -  by concatenating  ffContent + "\r\n" + oldComment


            Console.Write(newContent);

            Console.Write("");



        }

    }

}
